{"version":3,"file":"index.js","sources":["../../../cep.config.ts","../../../src/shared/shared.ts","../../../src/jsx/utils/samples.ts","../../../src/jsx/ppro/ppro.ts","../../../src/jsx/index.ts"],"sourcesContent":["import { CEP_Config } from \"vite-cep-plugin\";\r\nimport { version } from \"./package.json\";\r\n\r\nconst config: CEP_Config = {\r\n  version,\r\n  id: \"com.lasker.studio.cep\",\r\n  displayName: \"Lasker Studio\",\r\n  symlink: \"local\",\r\n  port: 3000,\r\n  servePort: 5000,\r\n  startingDebugPort: 8860,\r\n  extensionManifestVersion: 6.0,\r\n  requiredRuntimeVersion: 9.0,\r\n  hosts: [{ name: \"PPRO\", version: \"[0.0,99.9]\" }],\r\n\r\n  type: \"Panel\",\r\n  iconDarkNormal: \"./src/assets/light-icon.png\",\r\n  iconNormal: \"./src/assets/dark-icon.png\",\r\n  iconDarkNormalRollOver: \"./src/assets/light-icon.png\",\r\n  iconNormalRollOver: \"./src/assets/dark-icon.png\",\r\n  parameters: [\r\n    \"--v=0\",\r\n    \"--enable-nodejs\",\r\n    \"--mixed-context\",\r\n    \"--allow-file-access\",\r\n    \"--allow-file-access-from-files\",\r\n    \"--disable-site-isolation-trials\",\r\n  ],\r\n  width: 750,\r\n  height: 700,\r\n\r\n  panels: [\r\n    {\r\n      mainPath: \"./main/index.html\",\r\n      name: \"main\",\r\n      panelDisplayName: \"Lasker Studio\",\r\n      autoVisible: true,\r\n      width: 750,\r\n      height: 700,\r\n    },\r\n    // Debug panel removed for production\r\n    // {\r\n    //   mainPath: \"./debug/index.html\",\r\n    //   name: \"debug\",\r\n    //   panelDisplayName: \"Lasker Studio Debug\",\r\n    //   autoVisible: false,\r\n    //   width: 800,\r\n    //   height: 600,\r\n    // },\r\n  ],\r\n  build: {\r\n    jsxBin: \"off\",\r\n    sourceMap: true,\r\n  },\r\n  zxp: {\r\n    country: \"US\",\r\n    province: \"CA\",\r\n    org: \"Company\",\r\n    password: \"password\",\r\n    tsa: [\r\n      \"http://timestamp.digicert.com/\", // Windows Only\r\n      \"http://timestamp.apple.com/ts01\", // MacOS Only\r\n    ],\r\n    allowSkipTSA: false,\r\n    sourceMap: false,\r\n    jsxBin: \"off\",\r\n  },\r\n  installModules: [],\r\n  copyAssets: [],\r\n  copyZipAssets: [],\r\n};\r\nexport default config;\r\n","import config from \"../../cep.config\";\r\nexport const ns = config.id;\r\nexport const company = config.zxp.org;\r\nexport const displayName = config.displayName;\r\nexport const version = config.version;\r\n","export const helloVoid = (): void => {\r\n  alert(\"test\");\r\n};\r\nexport const helloError = (str: string) => {\r\n  // Intentional Error for Error Handling Demonstration\r\n  //@ts-ignore\r\n  throw new Error(`We're throwing an error`);\r\n};\r\n\r\nexport const helloStr = (str: string) => {\r\n  alert(`ExtendScript received a string: ${str}`);\r\n  return str;\r\n};\r\nexport const helloNum = (n: number) => {\r\n  alert(`ExtendScript received a number: ${n.toString()}`);\r\n  return n;\r\n};\r\nexport const helloArrayStr = (arr: string[]) => {\r\n  alert(\r\n    `ExtendScript received an array of ${arr.length} strings: ${arr.toString()}`\r\n  );\r\n  return arr;\r\n};\r\nexport const helloObj = (obj: { height: number; width: number }) => {\r\n  alert(`ExtendScript received an object: ${JSON.stringify(obj)}`);\r\n  return {\r\n    y: obj.height,\r\n    x: obj.width,\r\n  };\r\n};\r\n","import {\r\n  helloVoid,\r\n  helloError,\r\n  helloStr,\r\n  helloNum,\r\n  helloArrayStr,\r\n  helloObj,\r\n} from \"../utils/samples\";\r\nexport { helloError, helloStr, helloNum, helloArrayStr, helloObj, helloVoid };\r\nimport { dispatchTS } from \"../utils/utils\";\r\n\r\nexport const qeDomFunction = () => {\r\n  if (typeof qe === \"undefined\") {\r\n    app.enableQE();\r\n  }\r\n  if (qe) {\r\n    qe.name;\r\n    qe.project.getVideoEffectByName(\"test\");\r\n  }\r\n};\r\n\r\nexport const helloWorld = () => {\r\n  alert(\"Hello from Premiere Pro.\");\r\n};\r\n\r\ndeclare const $: any;\r\n\r\nexport const safeGetValue = (value: any) => {\r\n  return $._PPP_.safeGetValue(value);\r\n};\r\n\r\nexport const tickToObj = (t: any) => {\r\n  return $._PPP_.tickToObj(t);\r\n};\r\n\r\nexport const projectItemToSource = (\r\n  projectItem: any,\r\n  preferProxy?: boolean\r\n) => {\r\n  return $._PPP_.projectItemToSource(projectItem, preferProxy);\r\n};\r\n\r\nexport const dumpTrackItems = (track: any) => {\r\n  return $._PPP_.dumpTrackItems(track);\r\n};\r\n\r\nexport const getActiveSequenceName = () => {\r\n  return $._PPP_.getActiveSequenceName();\r\n};\r\n\r\nexport const getProjectSequences = () => {\r\n  return $._PPP_.getProjectSequences();\r\n};\r\n\r\nexport const getProjectSequencesSimple = () => {\r\n  return $._PPP_.getProjectSequencesSimple();\r\n};\r\n\r\nexport const openSequenceByGuid = (guid: string) => {\r\n  return $._PPP_.openSequenceByGuid(guid);\r\n};\r\n\r\nexport const getSequenceSnapshot = (sequenceId: string) => {\r\n  return $._PPP_.getSequenceSnapshot(sequenceId);\r\n};\r\n\r\nexport const getSequenceSnapshotFromSequence = (sequence: any) => {\r\n  return $._PPP_.getSequenceSnapshotFromSequence(sequence);\r\n};\r\n\r\nexport const exportSequenceData = (sequenceId: string) => {\r\n  return $._PPP_.exportSequenceData(sequenceId);\r\n};\r\n\r\nexport const exportActiveSequenceData = () => {\r\n  return $._PPP_.exportActiveSequenceData();\r\n};\r\n\r\nexport const generateSequenceThumbnail = (\r\n  sequenceId: string,\r\n  timestamp?: number\r\n) => {\r\n  return $._PPP_.generateSequenceThumbnail(sequenceId, timestamp);\r\n};\r\n\r\nexport const getMediaFilePaths = (\r\n  sequenceCreateData: any,\r\n  uploadUrls: any\r\n) => {\r\n  return $._PPP_.getMediaFilePaths(sequenceCreateData, uploadUrls);\r\n};\r\n\r\nexport const navigateToTime = (\r\n  sequenceId: string,\r\n  timeInSeconds: number\r\n) => {\r\n  return $._PPP_.navigateToTime(sequenceId, timeInSeconds);\r\n};\r\n\r\nexport const navigateActiveSequenceToTime = (\r\n  timeInSeconds: number\r\n) => {\r\n  return $._PPP_.navigateActiveSequenceToTime(timeInSeconds);\r\n};\r\n\r\nexport const applySBDCutsToSequence = (\r\n  sequenceId: string,\r\n  scenes: any[]\r\n) => {\r\n  return $._PPP_.applySBDCutsToSequence(sequenceId, scenes);\r\n};\r\n\r\nexport const applyCutsToSequence = (\r\n  sequenceId: string,\r\n  cuts: any[]\r\n) => {\r\n  return $._PPP_.applyCutsToSequence(sequenceId, cuts);\r\n};\r\n\r\nexport const razorActiveSequenceAtSceneBoundaries = (\r\n  scenes: { startSec: number; endSec: number; classification?: string | null; selectedTrack?: number | null }[],\r\n  options?: { applyLabels?: boolean; disableNonSelected?: boolean; createNewSequence?: boolean }\r\n) => {\r\n  return $._PPP_.razorActiveSequenceAtSceneBoundaries(scenes, options || {});\r\n};\r\n\r\n// Thumbnail export functions\r\nexport interface ExportFrameResult {\r\n  success: boolean;\r\n  path?: string;\r\n  cached?: boolean;\r\n  error?: string;\r\n}\r\n\r\nexport interface ExportFramesBatchResult {\r\n  success: boolean;\r\n  results?: { cacheKey: string; path?: string; cached?: boolean; error?: string }[];\r\n  exported?: number;\r\n  cached?: number;\r\n  failed?: number;\r\n  error?: string;\r\n}\r\n\r\nexport interface ClearThumbnailCacheResult {\r\n  success: boolean;\r\n  deletedCount?: number;\r\n  error?: string;\r\n}\r\n\r\nexport const exportFrameAtTime = (\r\n  timeSec: number,\r\n  cacheKey: string\r\n): ExportFrameResult => {\r\n  return $._PPP_.exportFrameAtTime(timeSec, cacheKey);\r\n};\r\n\r\nexport const exportFramesBatch = (\r\n  frames: { timeSec: number; cacheKey: string }[]\r\n): ExportFramesBatchResult => {\r\n  return $._PPP_.exportFramesBatch(frames);\r\n};\r\n\r\nexport const clearThumbnailCache = (): ClearThumbnailCacheResult => {\r\n  return $._PPP_.clearThumbnailCache();\r\n};\r\n\r\n// Video compression for upload\r\nexport interface CompressVideoResult {\r\n  success: boolean;\r\n  jobID?: string;\r\n  message?: string;\r\n  error?: string;\r\n}\r\n\r\nexport interface CompressionCompleteEvent {\r\n  jobID: string;\r\n  success: boolean;\r\n  inputPath: string;\r\n  outputPath?: string;\r\n  requestId: string;\r\n  error?: string;\r\n}\r\n\r\nexport interface CompressionProgressEvent {\r\n  jobID: string;\r\n  progress: number;\r\n  requestId: string;\r\n}\r\n\r\n/**\r\n * 비디오 파일을 업로드용 저해상도로 압축\r\n * Adobe Media Encoder를 사용하여 비동기적으로 압축\r\n */\r\nexport const compressVideoForUpload = (\r\n  inputPath: string,\r\n  outputDir: string,\r\n  presetPath: string,\r\n  requestId: string\r\n): CompressVideoResult => {\r\n  return $._PPP_.compressVideoForUpload(inputPath, outputDir, presetPath, requestId);\r\n};\r\n\r\n/**\r\n * 플러그인에 포함된 압축 프리셋 경로 반환\r\n */\r\nexport const getCompressionPresetPath = (): string => {\r\n  return $._PPP_.getCompressionPresetPath();\r\n};\r\n\r\n/**\r\n * 임시 폴더 경로 반환\r\n */\r\nexport const getTempFolder = (): string => {\r\n  return $._PPP_.getTempFolder();\r\n};\r\n\r\n// 시퀀스 직접 렌더링 (AME 없이)\r\nexport interface ExportSequenceDirectResult {\r\n  success: boolean;\r\n  outputPath?: string;\r\n  duration?: number;\r\n  fileSize?: number;\r\n  error?: string;\r\n}\r\n\r\nexport type WorkAreaType = 'entire' | 'inout' | 'workarea';\r\n\r\n/**\r\n * 시퀀스를 프리미어 프로 내장 인코더로 직접 렌더링 (AME 없이)\r\n * 블로킹 방식으로 완료까지 대기\r\n */\r\nexport const exportSequenceDirect = (\r\n  sequenceId: string,\r\n  outputPath: string,\r\n  presetPath: string,\r\n  workAreaType: WorkAreaType\r\n): ExportSequenceDirectResult => {\r\n  return $._PPP_.exportSequenceDirect(sequenceId, outputPath, presetPath, workAreaType);\r\n};\r\n\r\n// 클립별 Direct 렌더링 (특정 트랙, 특정 시간 범위)\r\nexport interface ExportClipDirectResult {\r\n  success: boolean;\r\n  outputPath?: string;\r\n  duration?: number;\r\n  fileSize?: number;\r\n  trackIndex?: number;\r\n  timeRange?: { start: number; end: number };\r\n  error?: string;\r\n}\r\n\r\n/**\r\n * 특정 트랙의 특정 시간 범위만 Direct 렌더링\r\n * - 해당 트랙만 활성화하고 나머지 트랙은 뮤트\r\n * - In/Out 포인트를 지정된 범위로 설정 후 렌더링\r\n * - 렌더링 후 원래 상태로 복원\r\n */\r\nexport const exportClipDirect = (\r\n  sequenceId: string,\r\n  trackIndex: number,\r\n  startTimeSec: number,\r\n  endTimeSec: number,\r\n  outputPath: string,\r\n  presetPath: string\r\n): ExportClipDirectResult => {\r\n  return $._PPP_.exportClipDirect(sequenceId, trackIndex, startTimeSec, endTimeSec, outputPath, presetPath);\r\n};\r\n","// @include './lib/json2.js'\r\n// @include './ppro/ppro.jsx'\r\n\r\nimport { ns } from \"../shared/shared\";\r\n\r\nimport * as ppro from \"./ppro/ppro\"; \r\n\r\n//@ts-ignore\r\nconst host = typeof $ !== \"undefined\" ? $ : window;\r\n\r\n// A safe way to get the app name since some versions of Adobe Apps broken BridgeTalk in various places (e.g. After Effects 24-25)\r\n// in that case we have to do various checks per app to deterimine the app name\r\n\r\nconst getAppNameSafely = (): ApplicationName | \"unknown\" => {\r\n  const compare = (a: string, b: string) => {\r\n    return a.toLowerCase().indexOf(b.toLowerCase()) > -1;\r\n  };\r\n  const exists = (a: any) => typeof a !== \"undefined\";\r\n  const isBridgeTalkWorking =\r\n    typeof BridgeTalk !== \"undefined\" &&\r\n    typeof BridgeTalk.appName !== \"undefined\";\r\n\r\n  if (isBridgeTalkWorking) {\r\n    return BridgeTalk.appName;\r\n  } else if (app) {\r\n    // Premiere Pro specific checks first (most reliable)\r\n    //@ts-ignore\r\n    if (exists(app.project) && exists(app.project.sequences)) {\r\n      // This is definitely Premiere Pro\r\n      return \"premierepro\";\r\n    }\r\n    //@ts-ignore\r\n    if (exists(app.name)) {\r\n      //@ts-ignore\r\n      const name: string = app.name;\r\n      if (compare(name, \"photoshop\")) return \"photoshop\";\r\n      if (compare(name, \"illustrator\")) return \"illustrator\";\r\n      if (compare(name, \"audition\")) return \"audition\";\r\n      if (compare(name, \"bridge\")) return \"bridge\";\r\n      if (compare(name, \"indesign\")) return \"indesign\";\r\n      if (compare(name, \"premiere\")) return \"premierepro\";\r\n    }\r\n    //@ts-ignore\r\n    if (exists(app.appName)) {\r\n      //@ts-ignore\r\n      const appName: string = app.appName;\r\n      if (compare(appName, \"after effects\")) return \"aftereffects\";\r\n      if (compare(appName, \"animate\")) return \"animate\";\r\n      if (compare(appName, \"premiere\")) return \"premierepro\";\r\n    }\r\n    //@ts-ignore\r\n    if (exists(app.path)) {\r\n      //@ts-ignore\r\n      const path: string = app.path;\r\n      if (compare(path, \"premiere\")) return \"premierepro\";\r\n      // Windows path format check\r\n      if (compare(path, \"Adobe Premiere Pro\")) return \"premierepro\";\r\n    }\r\n    //@ts-ignore\r\n    if (exists(app.getEncoderHost) && exists(AMEFrontendEvent)) {\r\n      return \"ame\";\r\n    }\r\n    // Additional Premiere Pro fallback - check for version property\r\n    //@ts-ignore\r\n    if (exists(app.version) && exists(app.project)) {\r\n      return \"premierepro\";\r\n    }\r\n  }\r\n  return \"unknown\";\r\n};\r\n\r\nswitch (getAppNameSafely()) {\r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  \r\n  case \"premierepro\":\r\n  case \"premiereprobeta\":\r\n    host[ns] = ppro;\r\n    break;\r\n}\r\n\r\nconst empty = {};\r\n// prettier-ignore\r\nexport type Scripts = typeof empty\r\n  & typeof ppro \r\n  ;\r\n\r\n// https://extendscript.docsforadobe.dev/interapplication-communication/bridgetalk-class.html?highlight=bridgetalk#appname\r\ntype ApplicationName =\r\n  | \"aftereffects\"\r\n  | \"aftereffectsbeta\"\r\n  | \"ame\"\r\n  | \"amebeta\"\r\n  | \"audition\"\r\n  | \"auditionbeta\"\r\n  | \"animate\"\r\n  | \"animatebeta\"\r\n  | \"bridge\"\r\n  | \"bridgebeta\"\r\n  // | \"flash\"\r\n  | \"illustrator\"\r\n  | \"illustratorbeta\"\r\n  | \"indesign\"\r\n  | \"indesignbeta\"\r\n  // | \"indesignserver\"\r\n  | \"photoshop\"\r\n  | \"photoshopbeta\"\r\n  | \"premierepro\"\r\n  | \"premiereprobeta\";\r\n"],"names":["version","alert","qe","host"],"mappings":"AAGA;AACEA;;ACHF;;ACDA;;AAEA;AACA;AACE;AACA;;AAEF;AAEA;AACEC;AACA;AACF;AACA;;AAEE;AACF;AACA;AACEA;AAGA;AACF;AACA;;;;;;AAMA;;AClBA;AACE;;AAEA;AACA;AACEC;AACAA;AACF;AACF;AAEA;;AAEA;AAIA;AACE;AACF;AAEA;AACE;AACF;AAEA;;AAKA;AAEA;AACE;AACF;AAEA;AACE;AACF;AAEA;AACE;AACF;AAEA;AACE;AACF;AAEA;AACE;AACF;AAEA;AACE;AACF;AAEA;AACE;AACF;AAEA;AACE;AACF;AAEA;AACE;AACF;AAEA;;AAKA;AAEA;;AAKA;AAEA;;AAKA;AAEA;AAGE;AACF;AAEA;;AAKA;AAEA;;AAKA;AAEA;AAIE;AACF;;AAEA;;AAuBA;;AAKA;AAEA;AAGE;AACF;AAEA;AACE;AACF;;AAEA;;AAuBA;AACA;AACA;AACA;AACA;AAME;AACF;;AAEA;AACA;AACA;AACA;AACE;AACF;;AAEA;AACA;AACA;AACA;AACE;AACF;;AAEA;;AAWA;AACA;AACA;AACA;AACA;AAME;AACF;;AAEA;;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AAQE;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClQA;;AAEA;AACA;;AAEA;;AAEI;;AAEF;;AAAmD;AACnD;AAIA;;;AAGE;AACA;AACA;AACE;AACA;AACF;AACA;AACA;AACE;AACA;;;;;;;AAOF;AACA;AACA;AACE;AACA;;;;AAIF;AACA;AACA;AACE;AACA;;AAEA;;AAEF;AACA;;AAEE;AACF;AACA;AACA;AACA;AACE;AACF;AACF;AACA;AACF;AAEA;AASE;AACA;AACEC;AACA;AACJ;AAGA;;AAKA"}