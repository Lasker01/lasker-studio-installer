<!DOCTYPE html>
<html lang="en">
  <head>
    <script>"use strict";
window.require = typeof require === "function" ? function (require, document) { var tmp = document.querySelector("script[data-main]"); if (tmp) {
    require(tmp.dataset.main);
} return require; }(require, document) : function (document) { var COMMA_DELIMITER = /,[ ]*/gim; var SLASH_DELIMITER = /[\/]+/gim; function loadPrerequisites() { var head = document.head; var tmpScripts = document.querySelector("script[data-scripts]"); var tmpStyles = document.querySelector("script[data-styles]"); var styles = tmpStyles ? tmpStyles.dataset.styles : ""; var scripts = tmpScripts ? tmpScripts.dataset.scripts : ""; var tmpBaseDir = document.querySelector("script[data-base_dir]"); var tag; var baseDir = tmpBaseDir && tmpBaseDir.dataset.base_dir; baseDir = baseDir && typeof baseDir === "string" ? baseDir : "./"; baseDir = new URL(baseDir, location.href).href; if (baseDir) {
    tag = document.createElement("base");
    tag.setAttribute("href", baseDir);
    head.append(tag);
} if (typeof styles === "string") {
    styles.trim().replace(COMMA_DELIMITER, ",").split(",").forEach(function (url) { tag = document.createElement("link"); tag.setAttribute("rel", "stylesheet"); tag.setAttribute("type", "text/css"); tag.setAttribute("href", url.trim()); head.append(tag); });
} if (typeof scripts === "string") {
    scripts.trim().replace(COMMA_DELIMITER, ",").split(",").forEach(function (url) { tag = document.createElement("script"); tag.setAttribute("type", "text/javascript"); tag.setAttribute("src", url.trim()); head.append(tag); });
} return baseDir; } function getSynchXHR(url) { var xhr = new XMLHttpRequest; xhr.open("GET", url, false); xhr.send(); return xhr; } function getFileName(filePath) { filePath = typeof filePath === "string" ? filePath : ""; if (filePath.indexOf(".") < 0) {
    var xhr = getSynchXHR("".concat(filePath, "/package.json"));
    if (xhr.status === 200) {
        var pack = JSON.parse(xhr.responseText);
        filePath = filePath + "/" + pack.main;
    }
} return filePath; } return function () { var modules = {}; var baseDir = loadPrerequisites(); var tmpMain = document.querySelector("script[data-main]"); var mainStr = tmpMain ? tmpMain.dataset.main : null; function require(dirname, file) { file = typeof file === "string" ? file.trim() : ""; var uri = new URL(file, dirname); uri.pathname = getFileName(uri.pathname); dirname = uri.href.substr(0, uri.href.lastIndexOf("/") + 1); var filename = uri.pathname.substr(uri.pathname.lastIndexOf("/") + 1); if (modules.hasOwnProperty(uri.href)) {
    return modules[uri.href];
}
else {
    var xhr = getSynchXHR(uri.href);
    if (xhr.status === 200) {
        var module = {};
        if (/(.json)$/gi.test(filename)) {
            module.exports = JSON.parse(xhr.responseText);
        }
        else {
            module.exports = {};
            new Function("exports", "require", "module", "__filename", "__dirname", "\n              ".concat(xhr.responseText, "\n              //# sourceURL=").concat(uri.href, "\n            ")).call(this, module.exports, require.bind(this, dirname), module, filename, dirname);
            modules[uri.href] = module.exports;
        }
        return module.exports;
    }
} return; } Object.defineProperty(require, "modules", { set: Function.prototype, get: function get() { return modules; } }); var req = require.bind(this, baseDir); if (mainStr) {
    window.addEventListener("load", req.bind(this, new URL(mainStr, baseDir).href));
} return req; }(); }(document);
</script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lasker Studio CEP</title>
    <!-- Pretendard Font (Korean + English) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css">
    <style>
      *, *::before, *::after {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: 'Pretendard Variable', Pretendard, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      /* Loading Screen Styles */
      .loading-screen {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background: #1a1a1a;
        color: #ffffff;
      }
      .loading-spinner {
        width: 40px;
        height: 40px;
        border: 3px solid rgba(255, 255, 255, 0.1);
        border-top-color: #3b82f6;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      .loading-text {
        margin-top: 16px;
        font-size: 14px;
        color: #9ca3af;
      }
      .loading-logo {
        margin-bottom: 24px;
        font-size: 20px;
        font-weight: 600;
        letter-spacing: -0.5px;
      }
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
    </style>
    
    
  </head>
  <body>
    <div id="app">
      <!-- Loading screen - React will replace this when mounted -->
      <div class="loading-screen">
        <div class="loading-logo">Lasker Studio</div>
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading...</div>
      </div>
    </div>
    
  
<script>
(function() {
  var CDN = 'https://lasker-studio-cep.vercel.app';
  var PANEL = 'main';
  var cacheBuster = Date.now();

  // 로딩 상태 업데이트
  function updateLoadingStatus(text) {
    var loadingText = document.querySelector('.loading-text');
    if (loadingText) loadingText.textContent = text;
  }

  // 에셋 로드 함수
  function loadAssets(baseUrl, files, isLocal) {
    var prefix = isLocal ? '../' : baseUrl + '/';
    var suffix = isLocal ? '' : '?t=' + cacheBuster;

    // CSS 로드
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.href = prefix + files.css + suffix;
    link.setAttribute('data-cdn-loader', 'true');
    document.head.appendChild(link);

    // JS 로드
    var script = document.createElement('script');
    script.type = 'module';
    script.src = prefix + files.js + suffix;
    script.setAttribute('data-cdn-loader', 'true');
    document.body.appendChild(script);

    console.log('[CDN Loader] ' + (isLocal ? 'Local' : 'CDN') + ' assets loaded:', files);
  }

  // CDN manifest fetch 시도 -> 실패 시 로컬 사용
  function loadFromCDNManifest() {
    updateLoadingStatus('Checking for updates...');

    fetch(CDN + '/manifest.json?t=' + cacheBuster, { cache: 'no-store' })
      .then(function(res) {
        if (!res.ok) throw new Error('CDN manifest fetch failed: ' + res.status);
        return res.json();
      })
      .then(function(manifest) {
        var files = manifest.files[PANEL];
        if (!files) {
          console.error('[CDN Loader] Panel not found in manifest');
          return loadFromLocal();
        }

        // 버전 정보 저장
        window.__LASKER_VERSION__ = manifest.version || '0.0.0';
        window.__LASKER_MANIFEST__ = manifest;
        console.log('[CDN Loader] Version:', window.__LASKER_VERSION__);

        updateLoadingStatus('Loading application...');
        loadAssets(CDN, files, false);
      })
      .catch(function(err) {
        console.warn('[CDN Loader] CDN manifest failed, using local:', err.message);
        loadFromLocal();
      });
  }

  // 로컬 fallback
  function loadFromLocal() {
    updateLoadingStatus('Loading from local...');

    fetch('../manifest.json')
      .then(function(res) { return res.json(); })
      .then(function(manifest) {
        var files = manifest.files[PANEL];
        if (!files) {
          updateLoadingStatus('Error: Panel not found');
          return;
        }

        window.__LASKER_VERSION__ = manifest.version || '0.0.0';
        window.__LASKER_MANIFEST__ = manifest;

        loadAssets('', files, true);
      })
      .catch(function(err) {
        console.error('[CDN Loader] Local manifest also failed:', err);
        updateLoadingStatus('Error loading plugin');
      });
  }

  // 먼저 CDN loader.js 시도
  var loaderUrl = CDN + '/loader.js?t=' + cacheBuster + '&panel=' + PANEL;
  var script = document.createElement('script');
  script.src = loaderUrl;
  script.onerror = function() {
    console.warn('[CDN Loader] loader.js failed, trying CDN manifest directly');
    loadFromCDNManifest();
  };
  document.head.appendChild(script);
})();
</script>
  </body>
</html>
