<!DOCTYPE html>
<html lang="en">
  <head>
    <script>"use strict";
window.require = typeof require === "function" ? function (require, document) { var tmp = document.querySelector("script[data-main]"); if (tmp) {
    require(tmp.dataset.main);
} return require; }(require, document) : function (document) { var COMMA_DELIMITER = /,[ ]*/gim; var SLASH_DELIMITER = /[\/]+/gim; function loadPrerequisites() { var head = document.head; var tmpScripts = document.querySelector("script[data-scripts]"); var tmpStyles = document.querySelector("script[data-styles]"); var styles = tmpStyles ? tmpStyles.dataset.styles : ""; var scripts = tmpScripts ? tmpScripts.dataset.scripts : ""; var tmpBaseDir = document.querySelector("script[data-base_dir]"); var tag; var baseDir = tmpBaseDir && tmpBaseDir.dataset.base_dir; baseDir = baseDir && typeof baseDir === "string" ? baseDir : "./"; baseDir = new URL(baseDir, location.href).href; if (baseDir) {
    tag = document.createElement("base");
    tag.setAttribute("href", baseDir);
    head.append(tag);
} if (typeof styles === "string") {
    styles.trim().replace(COMMA_DELIMITER, ",").split(",").forEach(function (url) { tag = document.createElement("link"); tag.setAttribute("rel", "stylesheet"); tag.setAttribute("type", "text/css"); tag.setAttribute("href", url.trim()); head.append(tag); });
} if (typeof scripts === "string") {
    scripts.trim().replace(COMMA_DELIMITER, ",").split(",").forEach(function (url) { tag = document.createElement("script"); tag.setAttribute("type", "text/javascript"); tag.setAttribute("src", url.trim()); head.append(tag); });
} return baseDir; } function getSynchXHR(url) { var xhr = new XMLHttpRequest; xhr.open("GET", url, false); xhr.send(); return xhr; } function getFileName(filePath) { filePath = typeof filePath === "string" ? filePath : ""; if (filePath.indexOf(".") < 0) {
    var xhr = getSynchXHR("".concat(filePath, "/package.json"));
    if (xhr.status === 200) {
        var pack = JSON.parse(xhr.responseText);
        filePath = filePath + "/" + pack.main;
    }
} return filePath; } return function () { var modules = {}; var baseDir = loadPrerequisites(); var tmpMain = document.querySelector("script[data-main]"); var mainStr = tmpMain ? tmpMain.dataset.main : null; function require(dirname, file) { file = typeof file === "string" ? file.trim() : ""; var uri = new URL(file, dirname); uri.pathname = getFileName(uri.pathname); dirname = uri.href.substr(0, uri.href.lastIndexOf("/") + 1); var filename = uri.pathname.substr(uri.pathname.lastIndexOf("/") + 1); if (modules.hasOwnProperty(uri.href)) {
    return modules[uri.href];
}
else {
    var xhr = getSynchXHR(uri.href);
    if (xhr.status === 200) {
        var module = {};
        if (/(.json)$/gi.test(filename)) {
            module.exports = JSON.parse(xhr.responseText);
        }
        else {
            module.exports = {};
            new Function("exports", "require", "module", "__filename", "__dirname", "\n              ".concat(xhr.responseText, "\n              //# sourceURL=").concat(uri.href, "\n            ")).call(this, module.exports, require.bind(this, dirname), module, filename, dirname);
            modules[uri.href] = module.exports;
        }
        return module.exports;
    }
} return; } Object.defineProperty(require, "modules", { set: Function.prototype, get: function get() { return modules; } }); var req = require.bind(this, baseDir); if (mainStr) {
    window.addEventListener("load", req.bind(this, new URL(mainStr, baseDir).href));
} return req; }(); }(document);
</script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Debug Console</title>

    <style>
      body {
        margin: 0;
        background: #1a1a1a;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      }
      #root {
        min-height: 100vh;
      }
      .loader {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        color: #888;
      }
      .loader-spinner {
        width: 40px;
        height: 40px;
        border: 3px solid #333;
        border-top-color: #61dafb;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      .loader-text {
        margin-top: 16px;
        font-size: 14px;
      }
      .loader-error {
        color: #ff6b6b;
        text-align: center;
        padding: 20px;
      }
      .loader-retry {
        margin-top: 12px;
        padding: 8px 16px;
        background: #333;
        border: 1px solid #555;
        color: #fff;
        border-radius: 4px;
        cursor: pointer;
      }
      .loader-retry:hover {
        background: #444;
      }
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
    </style>
  </head>
  <body>
    <div id="root">
      <div class="loader">
        <div class="loader-spinner"></div>
        <div class="loader-text">Loading...</div>
      </div>
    </div>

    <script>
      (function() {
        var CDN_BASE = 'https://lasker01.github.io/lasker-studio-cep';
        var MANIFEST_URL = CDN_BASE + '/manifest.json';
        var CACHE_KEY = 'lasker_studio_debug_cache';

        function showError(message) {
          var root = document.getElementById('root');
          root.innerHTML =
            '<div class="loader">' +
              '<div class="loader-error">' +
                '<p>' + message + '</p>' +
                '<button class="loader-retry" onclick="location.reload()">Retry</button>' +
              '</div>' +
            '</div>';
        }

        function updateLoaderText(text) {
          var loaderText = document.querySelector('.loader-text');
          if (loaderText) loaderText.textContent = text;
        }

        function loadScript(url) {
          return new Promise(function(resolve, reject) {
            var script = document.createElement('script');
            script.src = url;
            script.onload = resolve;
            script.onerror = reject;
            document.body.appendChild(script);
          });
        }

        function loadStyle(url) {
          return new Promise(function(resolve, reject) {
            var link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = url;
            link.onload = resolve;
            link.onerror = reject;
            document.head.appendChild(link);
          });
        }

        function getCache() {
          try {
            var cached = localStorage.getItem(CACHE_KEY);
            return cached ? JSON.parse(cached) : null;
          } catch (e) {
            return null;
          }
        }

        function setCache(manifest) {
          try {
            localStorage.setItem(CACHE_KEY, JSON.stringify(manifest));
          } catch (e) {}
        }

        function loadApp(manifest) {
          var files = manifest.files.debug;
          if (!files) {
            showError('Debug panel not available in this version');
            return;
          }
          updateLoaderText('Loading debug v' + manifest.version + '...');

          Promise.all([
            loadStyle(CDN_BASE + '/' + files.css),
            loadScript(CDN_BASE + '/' + files.js)
          ])
          .then(function() {
            setCache(manifest);
          })
          .catch(function(err) {
            showError('Failed to load debug resources');
            console.error('Load error:', err);
          });
        }

        function fetchManifest() {
          updateLoaderText('Checking for updates...');

          fetch(MANIFEST_URL + '?t=' + Date.now())
            .then(function(res) {
              if (!res.ok) throw new Error('HTTP ' + res.status);
              return res.json();
            })
            .then(function(manifest) {
              loadApp(manifest);
            })
            .catch(function(err) {
              console.warn('Manifest fetch failed:', err);
              var cached = getCache();
              if (cached) {
                updateLoaderText('Offline mode - using cached v' + cached.version);
                setTimeout(function() { loadApp(cached); }, 500);
              } else {
                showError('Cannot connect to server.<br>Please check your internet connection.');
              }
            });
        }

        // Start loading
        fetchManifest();
      })();
    </script>
  </body>
</html>
